<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="Motaz Mohammed Sameh">
<title>Change Data Capture With Debezium</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
.tabs {
    margin-bottom: 1.25em;
}

.tablist > ul {
    display: flex;
    flex-wrap: wrap;
    list-style: none;
    margin: 0;
    padding: 0;
}

.tablist > ul li {
    align-items: center;
    background-color: #fff;
    cursor: pointer;
    display: flex;
    font-weight: bold;
    line-height: 1.5;
    padding: 0.25em 1em;
    position: relative;
}

.tablist > ul li:focus-visible {
    outline: none;
}

.tablist.ulist,
.tablist.ulist > ul li {
    margin: 0;
}

.tablist.ulist > ul li + li {
    margin-left: 0.25em;
}

.tabs .tablist li::after {
    content: "";
    display: block;
    height: 1px;
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
}

.tabs.is-loading .tablist li:not(:first-child),
.tabs:not(.is-loading) .tablist li:not(.is-selected) {
    background-color: #f5f5f5;
}

.tabs.is-loading .tablist li:first-child::after,
.tabs:not(.is-loading) .tablist li.is-selected::after {
    background-color: #fff;
}

/*
.tabs:not(.is-loading) .tablist li,
.tabs:not(.is-loading) .tablist li::after {
  transition: background-color 200ms ease-in-out;
}
*/

.tablist > ul p {
    line-height: inherit;
    margin: 0;
}

.tabpanel {
    background-color: #fff;
    padding: 1.25em;
}

.tablist > ul li,
.tabpanel {
    border: 1px solid #dcdcdc;
}

.tablist > ul li {
    border-bottom: 0;
}

.tabs.is-loading .tabpanel + .tabpanel,
.tabs:not(.is-loading) .tabpanel.is-hidden {
    display: none;
}

.tabpanel > :first-child {
    margin-top: 0;
}

/* #content is a signature of the Asciidoctor standalone HTML output */
#content .tabpanel > :last-child,
#content .tabpanel > :last-child > :last-child,
#content .tabpanel > :last-child > :last-child > li:last-child > :last-child {
    margin-bottom: 0;
}

.tablecontainer {
    overflow-x: auto;
}

#content .tablecontainer {
    margin-bottom: 1.25em;
}

#content .tablecontainer > table.tableblock {
    margin-bottom: 0;
}
</style>
</head>
<body class="article">
<div id="header">
<h1>Change Data Capture With Debezium</h1>
<div class="details">
<span id="author" class="author">Motaz Mohammed Sameh</span><br>
<span id="email" class="email"><a href="mailto:motazco135@gmail.com">motazco135@gmail.com</a></span><br>
<span id="revnumber">version 3.0,</span>
<span id="revdate">August 18, 2023</span>
<br><span id="revremark">AsciiDoc article template</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_why_change_data_capture">Why Change Data Capture?</a></li>
<li><a href="#_debezium">Debezium</a>
<ul class="sectlevel2">
<li><a href="#_debezium_connectors">Debezium Connectors</a></li>
<li><a href="#_debezium_architecture">Debezium Architecture</a></li>
</ul>
</li>
<li><a href="#_use_case">Use Case</a>
<ul class="sectlevel2">
<li><a href="#_setup">SetUP</a></li>
<li><a href="#_create_database_tables">Create Database Tables</a></li>
<li><a href="#_debezium_kafka_connector_configuration">Debezium Kafka Connector Configuration</a></li>
<li><a href="#_check_created_kafka_topic">Check Created Kafka Topic</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_why_change_data_capture">Why Change Data Capture?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have a transaction log at our database systems which have all change events occurred in the Database systems will be appended in the transaction log (For each Inserter/UPDATE transaction/Delete).</p>
</div>
<div class="paragraph">
<p>This transaction logs table are used at replication of data between our database instances.</p>
</div>
<div class="paragraph">
<p>We have systems that require to have the data fresh and updated one the events occurred to process teh  data  and show instance updates.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debezium">Debezium</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Debezium Capture the changes from transaction log and propagate as events to any kind of downstream consumers.</p>
</div>
<div class="paragraph">
<p>This allows us to take the data from our operational database over to other systems that would like to have the data and process the data.</p>
</div>
<div class="paragraph">
<p>Debezium allow us to take the data as quickly as possible.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="resources/debezium.png" alt="Debezium-Log-based Change Data Capture">
</div>
<div class="title">Figure 1. Debezium-Log-based Change Data Capture</div>
</div>
<div class="paragraph">
<p>As shown in Figure 1 above we have the source systems database and Debezium use Database connectors based on the Database type so there is a connector for each database type,</p>
</div>
<div class="paragraph">
<p>We can push events the debezium capture from the source operational database directory to the downstream systems like Elasticsearch or to Data-warehouse .</p>
</div>
<div class="paragraph">
<p>However, we cloud add apache kafka in between this will enable to increase the  optionality that we can have, we can set up multiple consumers that will enable us to get teh  change events distributed to multiple systems at near realtime, so have the sink connector that take the data from kafka and push this changes to  downstream system directly.</p>
</div>
<div class="ulist">
<div class="title">Debezium is a CDC platform</div>
<ul>
<li>
<p>Based on the Transaction log.</p>
</li>
<li>
<p>Snapshotting, filtering</p>
</li>
<li>
<p>Outbox support</p>
</li>
<li>
<p>web-based ui</p>
</li>
<li>
<p>Fully open-source, very active community</p>
</li>
<li>
<p>Large production deployments</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_debezium_connectors">Debezium Connectors</h3>
<div class="paragraph">
<p>Debezium’s goal is to build up a library of connectors that capture changes from a variety of database management systems and produce events with very similar structures, making it far easier for your applications to consume and respond to the events regardless of where the changes originated.</p>
</div>
<div class="ulist">
<div class="title">Debezium Connectors:</div>
<ul>
<li>
<p>MongoDB</p>
</li>
<li>
<p>MySQL</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>SQL Server</p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>Db2</p>
</li>
<li>
<p>Cassandra</p>
</li>
<li>
<p>Vitess <strong>(Incubating)</strong></p>
</li>
<li>
<p>Spanner <strong>(Incubating)</strong></p>
</li>
<li>
<p>JDBC <strong>(Incubating)</strong></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>An incubating connector is one that has been released for preview purposes and is subject to changes that may not always be backward compatible.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debezium_architecture">Debezium Architecture</h3>
<div class="paragraph">
<div class="title">Apache kafka Connect</div>
<p>Most commonly debezium deployed by means of Apache kafka Connect, Kafka connect is a framework and runtime for implementing and operating :
<strong> Source connectors such as Debezium that send records into kafka.
</strong> Sink connectors that propagate records from kafka topics to other systems.</p>
</div>
<div class="paragraph">
<p>The following image shows the architecture of a change data capture pipline based on debezium:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="resources/debezium.png" alt="Debezium-Log-based Change Data Capture">
</div>
<div class="title">Figure 2. Debezium-Log-based Change Data Capture</div>
</div>
<div class="paragraph">
<p>As shown in the image, the debezium connectors for Oracle anf PostgresSql are deployed to capture changes to theses two types of databases. Each Debezium connector establishes a connection to its source database.</p>
</div>
<div class="paragraph">
<p>Kafka Connect operates as a separate service beside the kafka broker.</p>
</div>
<div class="paragraph">
<p>By default, changes from one database table are written to a Kafka topic whose name corresponds to the table name.</p>
</div>
<div class="paragraph">
<p>After change event records are in Apache Kafka, different connectors in the Kafka Connect eco-system can stream the records to other systems and databases such as Elasticsearch, data warehouses and analytics systems.</p>
</div>
<div class="paragraph">
<div class="title">Debezium Server</div>
<p>Another way to deploy Debezium is using the Debezium Server. The Debezium Server is a configurable, ready-to-use application that streams events from source database to a variety of messaging infrastructures.</p>
</div>
<div class="paragraph">
<p>The following image shows the architecture of a change data capture pipeline that uses the Debezium server:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="resources/dsebezium_server.png" alt="Debezium Server">
</div>
<div class="title">Figure 3. Debezium Server</div>
</div>
<div class="paragraph">
<p>The Debezium server is configured to use one of the Debezium source connectors to capture changes from the source database. Change events can be serialized to different formats like JSON or Apache Avro and then will be sent to one of a variety of messaging infrastructures such as Amazon Kinesis, Google Cloud Pub/Sub, or Apache Pulsar.</p>
</div>
<div class="paragraph">
<div class="title">Embedded Engine</div>
<p>Yet an alternative way for using the Debezium connectors is the embedded engine.</p>
</div>
<div class="paragraph">
<p>In this case, Debezium will not be run via Kafka Connect, but as a library embedded into your custom Java applications. This can be useful for either consuming change events within your application itself, without the needed for deploying complete Kafka and Kafka Connect clusters, or for streaming changes to alternative messaging brokers such as Amazon Kinesis.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case">Use Case</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start developing some real world UseCase scenario to evaluate our CDC approach,</p>
</div>
<div class="paragraph">
<p>Our use case will focus on updating customer bank account information and bank account balance,
we need to notify other systems regarding the customer account balance once the customer do any transaction.<br>
This will help in monitoring customer transaction behaviour in order to protect our customer against fraudulent by notifying the fraud monitoring system about the transaction.<br></p>
</div>
<div class="paragraph">
<p>We will assume that we have the following DB tables :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>T_Customers :<br>
This Table will contain our customer information.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">first_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer First Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">last_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer Last Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer Email address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mobile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer Mobile number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">created_at</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date of Creation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">updated_at</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date of update</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>T_Accounts :<br>
This will contain our customer accounts.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account_Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account Number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account_Status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicator about account status (Active,Inactive)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account_Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available Balance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer ID, to link account with Customer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">created_at</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date of Creation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">updated_at</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date of update</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>T_Transactions:<br>
This table will contain customer financial transaction.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">transaction_ref_number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique Transaction Reference Number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customer Account ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction_Amount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction_Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Type is Crediting or Debiting customer Account</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created_AT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date of creation of record in DB</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_setup">SetUP</h3>
<div class="paragraph">
<p>we will use docker compose to SetUp our environment which will contains :<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>confluent kafka</p>
</li>
<li>
<p>confluent kafka-connect</p>
</li>
<li>
<p>confluent control-center</p>
</li>
<li>
<p>Postgres DataBase</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'2'</span></span>
<span style="color:#606">services</span>:

  <span style="color:#606">broker</span>:
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">confluentinc/cp-kafka:7.4.0</span></span>
    <span style="color:#606">hostname</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">broker</span></span>
    <span style="color:#606">container_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">broker</span></span>
    <span style="color:#606">ports</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">9092:9092</span><span style="color:#710">&quot;</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">9101:9101</span><span style="color:#710">&quot;</span></span>
    <span style="color:#606">environment</span>:
      <span style="color:#606">KAFKA_NODE_ID</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT'</span></span>
      <span style="color:#606">KAFKA_ADVERTISED_LISTENERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'PLAINTEXT://broker:29092,PLAINTEXT_HOST://localhost:9092'</span></span>
      <span style="color:#606">KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">0</span></span>
      <span style="color:#606">KAFKA_TRANSACTION_STATE_LOG_MIN_ISR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">KAFKA_JMX_PORT</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">9101</span></span>
      <span style="color:#606">KAFKA_JMX_HOSTNAME</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">localhost</span></span>
      <span style="color:#606">KAFKA_PROCESS_ROLES</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'broker,controller'</span></span>
      <span style="color:#606">KAFKA_CONTROLLER_QUORUM_VOTERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'1@broker:29093'</span></span>
      <span style="color:#606">KAFKA_LISTENERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'PLAINTEXT://broker:29092,CONTROLLER://broker:29093,PLAINTEXT_HOST://0.0.0.0:9092'</span></span>
      <span style="color:#606">KAFKA_INTER_BROKER_LISTENER_NAME</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'PLAINTEXT'</span></span>
      <span style="color:#606">KAFKA_CONTROLLER_LISTENER_NAMES</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'CONTROLLER'</span></span>
      <span style="color:#606">KAFKA_LOG_DIRS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'/tmp/kraft-combined-logs'</span></span>
      <span style="color:#777"># Replace CLUSTER_ID with a unique base64 UUID using &quot;bin/kafka-storage.sh random-uuid&quot;</span>
      <span style="color:#777"># See https://docs.confluent.io/kafka/operations-tools/kafka-tools.html#kafka-storage-sh</span>
      <span style="color:#606">CLUSTER_ID</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'MkU3OEVBNTcwNTJENDM2Qk'</span></span>

  <span style="color:#606">schema-registry</span>:
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">confluentinc/cp-schema-registry:7.4.0</span></span>
    <span style="color:#606">hostname</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">schema-registry</span></span>
    <span style="color:#606">container_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">schema-registry</span></span>
    <span style="color:#606">depends_on</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">broker</span></span>
    <span style="color:#606">ports</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">8081:8081</span><span style="color:#710">&quot;</span></span>
    <span style="color:#606">environment</span>:
      <span style="color:#606">SCHEMA_REGISTRY_HOST_NAME</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">schema-registry</span></span>
      <span style="color:#606">SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'broker:29092'</span></span>
      <span style="color:#606">SCHEMA_REGISTRY_LISTENERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">http://0.0.0.0:8081</span></span>

  <span style="color:#606">kafka-connect</span>:
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">confluentinc/cp-kafka-connect-base:latest</span></span>
    <span style="color:#606">container_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kafka-connect</span></span>
    <span style="color:#606">depends_on</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">broker</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">schema-registry</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">db</span></span>
    <span style="color:#606">ports</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8083:8083</span></span>
    <span style="color:#606">links</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">db:database</span><span style="color:#710">&quot;</span></span>
    <span style="color:#606">environment</span>:
      <span style="color:#606">CONNECT_BOOTSTRAP_SERVERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">broker:29092</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">CONNECT_REST_PORT</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8083</span></span>
      <span style="color:#606">CONNECT_GROUP_ID</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kafka-connect</span></span>
      <span style="color:#606">CONNECT_CONFIG_STORAGE_TOPIC</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">_connect-configs</span></span>
      <span style="color:#606">CONNECT_OFFSET_STORAGE_TOPIC</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">_connect-offsets</span></span>
      <span style="color:#606">CONNECT_STATUS_STORAGE_TOPIC</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">_connect-status</span></span>
      <span style="color:#606">CONNECT_KEY_CONVERTER</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">org.apache.kafka.connect.storage.StringConverter</span></span>
      <span style="color:#606">CONNECT_VALUE_CONVERTER</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">io.confluent.connect.avro.AvroConverter</span></span>
      <span style="color:#606">CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_URL</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'http://schema-registry:8081'</span></span>
      <span style="color:#606">CONNECT_REST_ADVERTISED_HOST_NAME</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">kafka-connect</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">CONNECT_LOG4J_APPENDER_STDOUT_LAYOUT_CONVERSIONPATTERN</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">[%d] %p %X{connector.context}%m (%c:%L)%n</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">CONNECT_CONFIG_STORAGE_REPLICATION_FACTOR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">CONNECT_OFFSET_STORAGE_REPLICATION_FACTOR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">CONNECT_STATUS_STORAGE_REPLICATION_FACTOR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span>
    <span style="color:#777">#  ---------------</span>
      <span style="color:#606">CONNECT_PLUGIN_PATH</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/usr/share/java,/usr/share/confluent-hub-components,/data/connect-jars</span></span>
    <span style="color:#777"># If you want to use the Confluent Hub installer to d/l component, but make them available</span>
    <span style="color:#777"># when running this offline, spin up the stack once and then run :</span>
    <span style="color:#777">#   docker cp kafka-connect:/usr/share/confluent-hub-components ./data/connect-jars</span>
    <span style="color:#606">volumes</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">$PWD/data:/data</span></span>
    <span style="color:#777"># In the command section, $ are replaced with $$ to avoid the error 'Invalid interpolation format for &quot;command&quot; option'</span>
    <span style="color:#606">command</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">bash</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">-c</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">|</span></span>
        <span style="color:#F00;background-color:#FAA">echo &quot;Installing Connector&quot;</span>
        <span style="color:#F00;background-color:#FAA">confluent-hub install --no-prompt confluentinc/kafka-connect-jdbc:10.7.2</span>
        <span style="color:#F00;background-color:#FAA">confluent-hub install --no-prompt debezium/debezium-connector-postgresql:2.2.1</span>
        <span style="color:#777">#</span>
        <span style="color:#F00;background-color:#FAA">echo &quot;Launching Kafka Connect worker&quot;</span>
        <span style="color:#F00;background-color:#FAA">/etc/confluent/docker/run &amp;</span>
        <span style="color:#777">#</span>
        <span style="color:#F00;background-color:#FAA">sleep infinity</span>

  <span style="color:#606">control-center</span>:
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">confluentinc/cp-enterprise-control-center:7.4.0</span></span>
    <span style="color:#606">hostname</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">control-center</span></span>
    <span style="color:#606">container_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">control-center</span></span>
    <span style="color:#606">depends_on</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">broker</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">schema-registry</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kafka-connect</span></span>
    <span style="color:#606">ports</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">9021:9021</span><span style="color:#710">&quot;</span></span>
    <span style="color:#606">environment</span>:
      <span style="color:#606">CONTROL_CENTER_CONNECT_HEALTHCHECK_ENDPOINT</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'/connectors'</span></span>
      <span style="color:#606">CONTROL_CENTER_BOOTSTRAP_SERVERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'broker:29092'</span></span>
      <span style="color:#606">CONTROL_CENTER_CONNECT_CONNECT_CLUSTER</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'kafka-connect:8083'</span></span>
      <span style="color:#606">CONTROL_CENTER_SCHEMA_REGISTRY_URL</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://schema-registry:8081</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">CONTROL_CENTER_REPLICATION_FACTOR</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">CONTROL_CENTER_INTERNAL_TOPICS_PARTITIONS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">CONTROL_CENTER_MONITORING_INTERCEPTOR_TOPIC_PARTITIONS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">CONFLUENT_METRICS_TOPIC_REPLICATION</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
      <span style="color:#606">PORT</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">9021</span></span>
    <span style="color:#606">command</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">bash</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">-c</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">|</span></span>
        <span style="color:#F00;background-color:#FAA">echo &quot;Waiting two minutes for Kafka brokers to start and</span>
               <span style="color:#F00;background-color:#FAA">necessary topics to be available&quot;</span>
        <span style="color:#F00;background-color:#FAA">sleep 120</span>
        <span style="color:#F00;background-color:#FAA">/etc/confluent/docker/run</span>

  <span style="color:#606">rest-proxy</span>:
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">confluentinc/cp-kafka-rest:7.4.0</span></span>
    <span style="color:#606">depends_on</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">broker</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">schema-registry</span></span>
    <span style="color:#606">ports</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8082:8082</span></span>
    <span style="color:#606">hostname</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">rest-proxy</span></span>
    <span style="color:#606">container_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">rest-proxy</span></span>
    <span style="color:#606">environment</span>:
      <span style="color:#606">KAFKA_REST_HOST_NAME</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">rest-proxy</span></span>
      <span style="color:#606">KAFKA_REST_BOOTSTRAP_SERVERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'broker:29092'</span></span>
      <span style="color:#606">KAFKA_REST_LISTENERS</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://0.0.0.0:8082</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">KAFKA_REST_SCHEMA_REGISTRY_URL</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'http://schema-registry:8081'</span></span>

  <span style="color:#606">db</span>:
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
    <span style="color:#606">ports</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5432:5432</span></span>
    <span style="color:#606">expose</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5432</span></span>
    <span style="color:#606">environment</span>:
      <span style="color:#606">POSTGRES_PASSWORD</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To run Docker compose use the following :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">docker compose up</code></pre>
</div>
</div>
<div class="paragraph">
<p>once docker containers finished , you can validate the setup of kafka by hitting the url of Control Center
<a href="http://http://localhost:9021/" class="bare">http://http://localhost:9021/</a></p>
</div>
<div class="paragraph">
<p>DB setup validation you can connect to DB  using the following connection parameter from host machine :<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>* Username : postgres
* Password : postgres
* Port : 5432</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_database_tables">Create Database Tables</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Postgres Server Settings</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that the <strong><mark><a href="https://www.postgresql.org/docs/current/runtime-config-wal.html">wal_level</a></mark></strong> parameter is set to <strong><mark>logical</mark></strong> by running the query <strong><mark>SHOW wal_level</mark></strong> as the database RDS master user.</p>
</li>
<li>
<p>Configure user  <a href="https://debezium.io/documentation/reference/connectors/postgresql.html#postgresql-permissions">permissions.</a></p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the following script to create Tables :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span style="color:#B06;font-weight:bold">create</span> <span style="color:#339;font-weight:bold">table</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Customers</span><span style="color:#710">&quot;</span></span>
(
    ID         serial  <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
        <span style="color:#339;font-weight:bold">constraint</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Customers_pk</span><span style="color:#710">&quot;</span></span>
            <span style="color:#088;font-weight:bold">primary</span> <span style="color:#339;font-weight:bold">key</span>,
    first_name <span style="color:#0a8;font-weight:bold">varchar</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    last_name  <span style="color:#0a8;font-weight:bold">varchar</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    email      <span style="color:#0a8;font-weight:bold">varchar</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    mobile     <span style="color:#0a8;font-weight:bold">varchar</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    created_at <span style="color:#0a8;font-weight:bold">timestamp</span> <span style="color:#088;font-weight:bold">default</span> CURRENT_TIMESTAMP,
    updated_at <span style="color:#0a8;font-weight:bold">timestamp</span> <span style="color:#088;font-weight:bold">default</span> CURRENT_TIMESTAMP
);

<span style="color:#B06;font-weight:bold">create</span> <span style="color:#339;font-weight:bold">table</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts</span><span style="color:#710">&quot;</span></span>
(
    ID                serial  <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
        <span style="color:#339;font-weight:bold">constraint</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts_pk</span><span style="color:#710">&quot;</span></span>
            <span style="color:#088;font-weight:bold">primary</span> <span style="color:#339;font-weight:bold">key</span>,
    account_number  <span style="color:#0a8;font-weight:bold">integer</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    account_status  <span style="color:#0a8;font-weight:bold">varchar</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    account_balance <span style="color:#0a8;font-weight:bold">integer</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    customer_id     <span style="color:#0a8;font-weight:bold">integer</span> <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
        <span style="color:#339;font-weight:bold">constraint</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts_T_Customers_id_fk</span><span style="color:#710">&quot;</span></span>
            <span style="color:#080;font-weight:bold">references</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Customers</span><span style="color:#710">&quot;</span></span>,
    created_at        <span style="color:#0a8;font-weight:bold">timestamp</span> <span style="color:#088;font-weight:bold">default</span> CURRENT_TIMESTAMP,
    updated_at        <span style="color:#0a8;font-weight:bold">timestamp</span> <span style="color:#088;font-weight:bold">default</span> CURRENT_TIMESTAMP
);

<span style="color:#B06;font-weight:bold">create</span> <span style="color:#339;font-weight:bold">table</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Transactions</span><span style="color:#710">&quot;</span></span>
(
    id                     serial                             <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
        <span style="color:#339;font-weight:bold">constraint</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Transactions_pk</span><span style="color:#710">&quot;</span></span>
            <span style="color:#088;font-weight:bold">primary</span> <span style="color:#339;font-weight:bold">key</span>,
    transaction_ref_number <span style="color:#0a8;font-weight:bold">varchar</span>                             <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    customer_id            <span style="color:#0a8;font-weight:bold">integer</span>                             <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
        <span style="color:#339;font-weight:bold">constraint</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Transactions_T_Customers_id_fk</span><span style="color:#710">&quot;</span></span>
            <span style="color:#080;font-weight:bold">references</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Customers</span><span style="color:#710">&quot;</span></span>,
    account_id             <span style="color:#0a8;font-weight:bold">integer</span>                             <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
        <span style="color:#339;font-weight:bold">constraint</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Transactions_T_Accounts_id_fk</span><span style="color:#710">&quot;</span></span>
            <span style="color:#080;font-weight:bold">references</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts</span><span style="color:#710">&quot;</span></span>,
    transaction_amount     <span style="color:#0a8;font-weight:bold">integer</span>                             <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    transaction_type       <span style="color:#0a8;font-weight:bold">varchar</span>                             <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>,
    created_at             <span style="color:#0a8;font-weight:bold">timestamp</span> <span style="color:#088;font-weight:bold">default</span> CURRENT_TIMESTAMP <span style="color:#080;font-weight:bold">not</span> <span style="color:#069">null</span>
);</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="resources/ERD-digram.png" alt="ERD Diagram">
</div>
<div class="title">Figure 4. ERD Diagram</div>
</div>
</div>
<div class="sect2">
<h3 id="_debezium_kafka_connector_configuration">Debezium Kafka Connector Configuration</h3>
<div class="paragraph">
<p>Following is the configuration for a PostgreSQL connector that connects to a PostgreSQL server on port 5432 at Host: db which is to name of the container in the docker compose, whose logical name is fulfillment. <br></p>
</div>
<div class="paragraph">
<p>We can choose to produce events for a subset of the schemas and tables in a database. Optionally, we can ignore, mask, or truncate columns that contain sensitive data, are larger than a specified size, or that we do not need.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fulfillment-connector</span><span style="color:#710">&quot;</span></span>,
  <span style="color:#606"><span style="color:#404">&quot;</span><span>config</span><span style="color:#404">&quot;</span></span>: {
    <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fulfillment-connector</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>connector.class</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">io.debezium.connector.postgresql.PostgresConnector</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>tasks.max</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>topic.prefix</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fulfillment</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>database.hostname</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">db</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>database.port</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">5432</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>database.user</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">postgres</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>database.password</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">********</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>database.dbname</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Test</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>plugin.name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pgoutput</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>slot.name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">debezium_01</span><span style="color:#710">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_check_created_kafka_topic">Check Created Kafka Topic</h3>
<div class="paragraph">
<p>Now we will start Insert and update some records in the DB and check the Kafka topic.</p>
</div>
<div class="paragraph">
<p>Run the following database insert statement :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span style="color:#B06;font-weight:bold">INTO</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Customers</span><span style="color:#710">&quot;</span></span> (id, first_name, last_name, email, mobile, created_at, updated_at) <span style="color:#080;font-weight:bold">VALUES</span> (<span style="color:#088;font-weight:bold">DEFAULT</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">motaz</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">motaz</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">motaz@test.com</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">0555555555</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="color:#088;font-weight:bold">DEFAULT</span>, <span style="color:#088;font-weight:bold">DEFAULT</span>)

<span style="color:#B06;font-weight:bold">INSERT</span> <span style="color:#B06;font-weight:bold">INTO</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts</span><span style="color:#710">&quot;</span></span> (id, account_number, account_status, account_balance, customer_id, created_at, updated_at) <span style="color:#080;font-weight:bold">VALUES</span> (<span style="color:#088;font-weight:bold">DEFAULT</span>, <span style="color:#00D">111</span>::<span style="color:#0a8;font-weight:bold">integer</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">active</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="color:#00D">1000</span>::<span style="color:#0a8;font-weight:bold">integer</span>, <span style="color:#00D">1</span>::<span style="color:#0a8;font-weight:bold">integer</span>, <span style="color:#088;font-weight:bold">DEFAULT</span>, <span style="color:#088;font-weight:bold">DEFAULT</span>);

<span style="color:#B06;font-weight:bold">UPDATE</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts</span><span style="color:#710">&quot;</span></span> <span style="color:#B06;font-weight:bold">SET</span> account_status = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">in-active</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span> <span style="color:#080;font-weight:bold">WHERE</span> id = <span style="color:#00D">1</span>::<span style="color:#0a8;font-weight:bold">integer</span>;

<span style="color:#B06;font-weight:bold">INSERT</span> <span style="color:#B06;font-weight:bold">INTO</span> public.<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Transactions</span><span style="color:#710">&quot;</span></span> (id, transaction_ref_number, customer_id, account_id, transaction_amount, transaction_type, created_at) <span style="color:#080;font-weight:bold">VALUES</span> (<span style="color:#088;font-weight:bold">DEFAULT</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">ref-01</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="color:#00D">1</span>::<span style="color:#0a8;font-weight:bold">integer</span>, <span style="color:#00D">1</span>::<span style="color:#0a8;font-weight:bold">integer</span>, <span style="color:#00D">10</span>::<span style="color:#0a8;font-weight:bold">integer</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Credit</span><span style="color:#710">'</span></span>::<span style="color:#0a8;font-weight:bold">varchar</span>, <span style="color:#088;font-weight:bold">DEFAULT</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now after running the query we should go and check the kafka control center, in order to check the created kafka topics.<br>
We should found the following kafka topics created :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="resources/kafka-topics.png" alt="Kafka Control Center">
</div>
<div class="title">Figure 5. Kafka Control Center</div>
</div>
<div class="paragraph">
<p>We will found that we have a three created topics each one represents a table that we had run a query on it and topic name starts with the prefix that we have defined.</p>
</div>
<div class="paragraph">
<p>We can check the published messages in the kafka topic for validation.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on topic from control center Example : <mark>fulfillment.public.T_Accounts </mark></p>
</li>
<li>
<p>Click on messages.</p>
</li>
<li>
<p>Select offset 0 at jump to offset.</p>
</li>
<li>
<p>We will see the following message :</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="resources/kafka-topic-messages.png" alt="Kafka Topic message-viewer">
</div>
<div class="title">Figure 6. Kafka Topic message-viewer</div>
</div>
<div class="paragraph">
<p>we will see two messages first message is related to the insert statement and the second message related to the update statement.</p>
</div>
<div class="paragraph">
<p>You will notice that the message contains json object as following :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
    {
        <span style="color:#606"><span style="color:#404">&quot;</span><span>topic</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fulfillment.public.T_Accounts</span><span style="color:#710">&quot;</span></span>,
        <span style="color:#606"><span style="color:#404">&quot;</span><span>partition</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
        <span style="color:#606"><span style="color:#404">&quot;</span><span>offset</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>,
        <span style="color:#606"><span style="color:#404">&quot;</span><span>timestamp</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1701901434642</span>,
        <span style="color:#606"><span style="color:#404">&quot;</span><span>timestampType</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">CREATE_TIME</span><span style="color:#710">&quot;</span></span>,
        <span style="color:#606"><span style="color:#404">&quot;</span><span>headers</span><span style="color:#404">&quot;</span></span>: [],
        <span style="color:#606"><span style="color:#404">&quot;</span><span>key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Struct{id=1}</span><span style="color:#710">&quot;</span></span>,
        <span style="color:#606"><span style="color:#404">&quot;</span><span>value</span><span style="color:#404">&quot;</span></span>: {
            <span style="color:#606"><span style="color:#404">&quot;</span><span>before</span><span style="color:#404">&quot;</span></span>: <span style="color:#088">null</span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>after</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>fulfillment.public.T_Accounts.Value</span><span style="color:#404">&quot;</span></span>: {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>id</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1</span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>account_number</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">111</span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>account_status</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">active</span><span style="color:#710">&quot;</span></span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>account_balance</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1000</span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>customer_id</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1</span>,
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>created_at</span><span style="color:#404">&quot;</span></span>: {
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>long</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1701901434200964</span>
                    },
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>updated_at</span><span style="color:#404">&quot;</span></span>: {
                        <span style="color:#606"><span style="color:#404">&quot;</span><span>long</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1701901434200964</span>
                    }
                }
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>source</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>version</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2.2.1.Final</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>connector</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">postgresql</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fulfillment</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>ts_ms</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1701901434224</span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>snapshot</span><span style="color:#404">&quot;</span></span>: {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>string</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span>
                },
                <span style="color:#606"><span style="color:#404">&quot;</span><span>db</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Test</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>sequence</span><span style="color:#404">&quot;</span></span>: {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>string</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">[</span><span style="color:#b0b">\&quot;</span><span style="color:#D20">31538088</span><span style="color:#b0b">\&quot;</span><span style="color:#D20">,</span><span style="color:#b0b">\&quot;</span><span style="color:#D20">31538304</span><span style="color:#b0b">\&quot;</span><span style="color:#D20">]</span><span style="color:#710">&quot;</span></span>
                },
                <span style="color:#606"><span style="color:#404">&quot;</span><span>schema</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">public</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>table</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T_Accounts</span><span style="color:#710">&quot;</span></span>,
                <span style="color:#606"><span style="color:#404">&quot;</span><span>txId</span><span style="color:#404">&quot;</span></span>: {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>long</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">774</span>
                },
                <span style="color:#606"><span style="color:#404">&quot;</span><span>lsn</span><span style="color:#404">&quot;</span></span>: {
                    <span style="color:#606"><span style="color:#404">&quot;</span><span>long</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">31538304</span>
                },
                <span style="color:#606"><span style="color:#404">&quot;</span><span>xmin</span><span style="color:#404">&quot;</span></span>: <span style="color:#088">null</span>
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>op</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">c</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#606"><span style="color:#404">&quot;</span><span>ts_ms</span><span style="color:#404">&quot;</span></span>: {
                <span style="color:#606"><span style="color:#404">&quot;</span><span>long</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">1701901434351</span>
            },
            <span style="color:#606"><span style="color:#404">&quot;</span><span>transaction</span><span style="color:#404">&quot;</span></span>: <span style="color:#088">null</span>
        },
        <span style="color:#606"><span style="color:#404">&quot;</span><span>__confluent_index</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">0</span>
    }
]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fraud tool will be able to use the data from the Kafka topic to begin creating the customer profile because we have now established a CDC data flow and are able to publish the data in almost real-time.</p>
</div>
<div class="paragraph">
<p>Next, we&#8217;ll look at how the established CDC can be used to build the Operational Data Store layer.</p>
</div>
<div class="paragraph">
<p><a href="https://motazco135.github.io/blog/">&#8592;Back</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.0<br>
Last updated 2023-12-07 02:44:36 +0300
</div>
</div>
<script>
;(function () { /*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
  'use strict'

  var config = (document.currentScript || {}).dataset || {}
  var forEach = Array.prototype.forEach

  init(document.querySelectorAll('.tabs'))

  function init (tabsBlocks) {
    if (!tabsBlocks.length) return
    forEach.call(tabsBlocks, function (tabs) {
      var syncIds = tabs.classList.contains('is-sync') ? {} : undefined
      var tablist = tabs.querySelector('.tablist ul')
      tablist.setAttribute('role', 'tablist')
      var start
      forEach.call(tablist.querySelectorAll('li'), function (tab, idx) {
        tab.tabIndex = -1
        tab.setAttribute('role', tab.classList.add('tab') || 'tab')
        var id, anchor, syncId
        if (!(id = tab.id) && (anchor = tab.querySelector('a[id]'))) {
          id = tab.id = anchor.parentNode.removeChild(anchor).id
        }
        var panel = id && tabs.querySelector('.tabpanel[aria-labelledby~="' + id + '"]')
        if (!panel) return idx ? undefined : toggleSelected(tab, true) // invalid state
        syncIds && (((syncId = tab.textContent.trim()) in syncIds) ? (syncId = undefined) : true) &&
        (syncIds[(tab.dataset.syncId = syncId)] = tab)
        idx || (syncIds && (start = { tab: tab, panel: panel })) ? toggleHidden(panel, true) : toggleSelected(tab, true)
        tab.setAttribute('aria-controls', panel.id)
        panel.setAttribute('role', 'tabpanel')
        var onClick = syncId === undefined ? activateTab : activateTabSync
        tab.addEventListener('click', onClick.bind({ tabs: tabs, tab: tab, panel: panel }))
      })
      if (!tabs.closest('.tabpanel')) {
        forEach.call(tabs.querySelectorAll('.tabpanel table.tableblock'), function (table) {
          var container = Object.assign(document.createElement('div'), { className: 'tablecontainer' })
          table.parentNode.insertBefore(container, table).appendChild(table)
        })
      }
      if (start) {
        var syncGroupId
        for (var i = 0, lst = tabs.classList, len = lst.length, className; i !== len; i++) {
          if (!(className = lst.item(i)).startsWith('data-sync-group-id=')) continue
          tabs.dataset.syncGroupId = syncGroupId = lst.remove(className) || className.slice(19).replace(/\u00a0/g, ' ')
          break
        }
        if (syncGroupId === undefined) tabs.dataset.syncGroupId = syncGroupId = Object.keys(syncIds).sort().join('|')
        var preferredSyncId = 'syncStorageKey' in config &&
          window[(config.syncStorageScope || 'local') + 'Storage'].getItem(config.syncStorageKey + '-' + syncGroupId)
        var tab = preferredSyncId && syncIds[preferredSyncId]
        tab && Object.assign(start, { tab: tab, panel: document.getElementById(tab.getAttribute('aria-controls')) })
        toggleSelected(start.tab, true) || toggleHidden(start.panel, false)
      }
    })
    onHashChange()
    toggleClassOnEach(tabsBlocks, 'is-loading', 'remove')
    window.setTimeout(toggleClassOnEach.bind(null, tabsBlocks, 'is-loaded', 'add'), 0)
    window.addEventListener('hashchange', onHashChange)
  }

  function activateTab (e) {
    var tab = this.tab
    var tabs = this.tabs || (this.tabs = tab.closest('.tabs'))
    var panel = this.panel || (this.panel = document.getElementById(tab.getAttribute('aria-controls')))
    querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (el) {
      toggleSelected(el, el === tab)
    })
    querySelectorWithSiblings(tabs, '.tabpanel', 'tabpanel').forEach(function (el) {
      toggleHidden(el, el !== panel)
    })
    if (!this.isSync && 'syncStorageKey' in config && 'syncGroupId' in tabs.dataset) {
      var storageKey = config.syncStorageKey + '-' + tabs.dataset.syncGroupId
      window[(config.syncStorageScope || 'local') + 'Storage'].setItem(storageKey, tab.dataset.syncId)
    }
    if (!e) return
    var loc = window.location
    var hashIdx = loc.hash ? loc.href.indexOf('#') : -1
    if (~hashIdx) window.history.replaceState(null, '', loc.href.slice(0, hashIdx))
    e.preventDefault()
  }

  function activateTabSync (e) {
    activateTab.call(this, e)
    var thisTabs = this.tabs
    var thisTab = this.tab
    var initialY = thisTabs.getBoundingClientRect().y
    forEach.call(document.querySelectorAll('.tabs'), function (tabs) {
      if (tabs === thisTabs || tabs.dataset.syncGroupId !== thisTabs.dataset.syncGroupId) return
      querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (tab) {
        if (tab.dataset.syncId === thisTab.dataset.syncId) activateTab.call({ tabs: tabs, tab: tab, isSync: true })
      })
    })
    var shiftedBy = thisTabs.getBoundingClientRect().y - initialY
    if (shiftedBy && (shiftedBy = Math.round(shiftedBy))) window.scrollBy({ top: shiftedBy, behavior: 'instant' })
  }

  function querySelectorWithSiblings (scope, selector, siblingClass) {
    var el = scope.querySelector(selector)
    if (!el) return []
    var result = [el]
    while ((el = el.nextElementSibling) && el.classList.contains(siblingClass)) result.push(el)
    return result
  }

  function toggleClassOnEach (elements, className, method) {
    forEach.call(elements, function (el) {
      el.classList[method](className)
    })
  }

  function toggleHidden (el, state) {
    el.classList[(el.hidden = state) ? 'add' : 'remove']('is-hidden')
  }

  function toggleSelected (el, state) {
    el.setAttribute('aria-selected', '' + state)
    el.classList[state ? 'add' : 'remove']('is-selected')
    el.tabIndex = state ? 0 : -1
  }

  function onHashChange () {
    var id = window.location.hash.slice(1)
    if (!id) return
    var tab = document.getElementById(~id.indexOf('%') ? decodeURIComponent(id) : id)
    if (!(tab && tab.classList.contains('tab'))) return
    'syncId' in tab.dataset ? activateTabSync.call({ tab: tab }) : activateTab.call({ tab: tab })
  }
})()
</script>
</body>
</html>